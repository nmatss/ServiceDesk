<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>WCAG AA Contrast Validation Tool</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      padding: 2rem;
      background: #f5f5f5;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 12px;
      padding: 2rem;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }

    h1 {
      font-size: 2rem;
      margin-bottom: 1rem;
      color: #111827;
    }

    .subtitle {
      color: #6b7280;
      margin-bottom: 2rem;
    }

    .test-grid {
      display: grid;
      gap: 1.5rem;
      margin-top: 2rem;
    }

    .test-card {
      border: 2px solid #e5e7eb;
      border-radius: 8px;
      padding: 1.5rem;
      background: #fafafa;
    }

    .test-card.pass {
      border-color: #10b981;
      background: #f0fdf4;
    }

    .test-card.fail {
      border-color: #ef4444;
      background: #fef2f2;
    }

    .test-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
    }

    .test-title {
      font-weight: 600;
      font-size: 1.1rem;
      color: #111827;
    }

    .badge {
      padding: 0.25rem 0.75rem;
      border-radius: 9999px;
      font-size: 0.875rem;
      font-weight: 600;
    }

    .badge.pass {
      background: #10b981;
      color: white;
    }

    .badge.fail {
      background: #ef4444;
      color: white;
    }

    .test-details {
      display: grid;
      gap: 0.5rem;
      margin-bottom: 1rem;
      font-size: 0.875rem;
    }

    .test-sample {
      margin-top: 1rem;
      padding: 1rem;
      border-radius: 6px;
      font-size: 0.875rem;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 2rem;
      padding-top: 2rem;
      border-top: 2px solid #e5e7eb;
    }

    .stat-card {
      padding: 1rem;
      border-radius: 8px;
      text-align: center;
    }

    .stat-value {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 0.25rem;
    }

    .stat-label {
      font-size: 0.875rem;
      color: #6b7280;
    }

    code {
      background: #f3f4f6;
      padding: 0.125rem 0.375rem;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
      font-size: 0.875rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ðŸŽ¨ WCAG AA Contrast Validation</h1>
    <p class="subtitle">ServiceDesk Pro - Dark Mode Color Compliance Test</p>

    <div id="results"></div>
    <div id="stats"></div>
  </div>

  <script>
    // FunÃ§Ã£o para calcular luminÃ¢ncia relativa (WCAG formula)
    function getLuminance(r, g, b) {
      const [rs, gs, bs] = [r, g, b].map(c => {
        c = c / 255;
        return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);
      });
      return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
    }

    // FunÃ§Ã£o para calcular contrast ratio
    function getContrastRatio(fg, bg) {
      const l1 = getLuminance(...fg) + 0.05;
      const l2 = getLuminance(...bg) + 0.05;
      return l1 > l2 ? l1 / l2 : l2 / l1;
    }

    // Converter hex para RGB
    function hexToRgb(hex) {
      const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? [
        parseInt(result[1], 16),
        parseInt(result[2], 16),
        parseInt(result[3], 16)
      ] : null;
    }

    // Testes de contraste
    const tests = [
      {
        name: 'Primary Text (Dark Mode)',
        description: 'text-neutral-100 em bg-neutral-900',
        fg: '#f3f4f6',
        bg: '#111827',
        wcagAA: 4.5,
        wcagAAA: 7.0
      },
      {
        name: 'Secondary Text (Dark Mode) - FIXED',
        description: 'text-neutral-300 (--color-text-secondary) em bg-neutral-900',
        fg: '#d1d5db',
        bg: '#111827',
        wcagAA: 4.5,
        wcagAAA: 7.0
      },
      {
        name: 'Tertiary Text (Dark Mode) - FIXED',
        description: 'text-neutral-400 (--color-text-tertiary) em bg-neutral-900',
        fg: '#9ca3af',
        bg: '#111827',
        wcagAA: 4.5,
        wcagAAA: 7.0
      },
      {
        name: 'Muted Foreground (Dark Mode) - FIXED',
        description: 'text-muted-foreground em bg-neutral-900',
        fg: '#aab0ba', // hsl(215.4, 16.3%, 70%)
        bg: '#111827',
        wcagAA: 4.5,
        wcagAAA: 7.0
      },
      {
        name: 'Premium Dark Secondary - FIXED',
        description: 'Premium dark mode secondary text',
        fg: '#d4d4d8',
        bg: '#0a0a0c',
        wcagAA: 4.5,
        wcagAAA: 7.0
      },
      {
        name: 'Premium Dark Tertiary - FIXED',
        description: 'Premium dark mode tertiary text',
        fg: '#a1a1aa',
        bg: '#0a0a0c',
        wcagAA: 4.5,
        wcagAAA: 7.0
      },
      {
        name: 'Landing Page Description',
        description: 'text-muted-foreground em hero section',
        fg: '#aab0ba',
        bg: '#111827',
        wcagAA: 4.5,
        wcagAAA: 7.0
      }
    ];

    let passCount = 0;
    let failCount = 0;
    let totalRatio = 0;

    const resultsHTML = tests.map(test => {
      const ratio = getContrastRatio(hexToRgb(test.fg), hexToRgb(test.bg));
      const passAA = ratio >= test.wcagAA;
      const passAAA = ratio >= test.wcagAAA;

      totalRatio += ratio;
      if (passAA) passCount++;
      else failCount++;

      return `
        <div class="test-card ${passAA ? 'pass' : 'fail'}">
          <div class="test-header">
            <div class="test-title">${test.name}</div>
            <div class="badge ${passAA ? 'pass' : 'fail'}">${passAA ? 'âœ“ PASS' : 'âœ— FAIL'}</div>
          </div>
          <div class="test-details">
            <div><strong>DescriÃ§Ã£o:</strong> ${test.description}</div>
            <div><strong>Foreground:</strong> <code>${test.fg}</code></div>
            <div><strong>Background:</strong> <code>${test.bg}</code></div>
            <div><strong>Contrast Ratio:</strong> <code>${ratio.toFixed(2)}:1</code></div>
            <div><strong>WCAG AA (4.5:1):</strong> ${passAA ? 'âœ“ Pass' : 'âœ— Fail'} ${passAAA ? ' | AAA (7:1): âœ“ Pass' : ''}</div>
          </div>
          <div class="test-sample" style="background: ${test.bg}; color: ${test.fg};">
            Sample text: Acompanhe o status das suas solicitaÃ§Ãµes em tempo real com dashboards intuitivos.
          </div>
        </div>
      `;
    }).join('');

    document.getElementById('results').innerHTML = `
      <div class="test-grid">
        ${resultsHTML}
      </div>
    `;

    const avgRatio = (totalRatio / tests.length).toFixed(2);
    const compliance = ((passCount / tests.length) * 100).toFixed(0);

    document.getElementById('stats').innerHTML = `
      <div class="stats">
        <div class="stat-card" style="background: #f0fdf4;">
          <div class="stat-value" style="color: #10b981;">${passCount}</div>
          <div class="stat-label">Tests Passed</div>
        </div>
        <div class="stat-card" style="background: ${failCount > 0 ? '#fef2f2' : '#f0fdf4'};">
          <div class="stat-value" style="color: ${failCount > 0 ? '#ef4444' : '#10b981'};">${failCount}</div>
          <div class="stat-label">Tests Failed</div>
        </div>
        <div class="stat-card" style="background: #eff6ff;">
          <div class="stat-value" style="color: #3b82f6;">${avgRatio}:1</div>
          <div class="stat-label">Average Ratio</div>
        </div>
        <div class="stat-card" style="background: ${compliance >= 100 ? '#f0fdf4' : '#fef2f2'};">
          <div class="stat-value" style="color: ${compliance >= 100 ? '#10b981' : '#ef4444'};">${compliance}%</div>
          <div class="stat-label">Compliance</div>
        </div>
      </div>
    `;
  </script>
</body>
</html>
