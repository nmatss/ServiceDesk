# Slack Notifications Configuration for Alertmanager
#
# This provides Slack integration for non-critical alerts

# Slack webhook configuration
slack_configs:
  # Main alerts channel
  - name: 'slack-alerts'
    api_url: '<YOUR_SLACK_WEBHOOK_URL>'
    channel: '#servicedesk-alerts'
    username: 'ServiceDesk Monitor'
    icon_emoji: ':bell:'
    title: '{{ .GroupLabels.alertname }}'
    title_link: 'https://grafana.yourcompany.com'
    text: |-
      {{ range .Alerts }}
      *Alert:* {{ .Annotations.summary }}
      *Description:* {{ .Annotations.description }}
      *Severity:* {{ .Labels.severity }}
      *Component:* {{ .Labels.component }}
      {{ if .Annotations.runbook_url }}*Runbook:* {{ .Annotations.runbook_url }}{{ end }}
      {{ end }}
    color: |-
      {{ if eq .Status "firing" }}
        {{ if eq .GroupLabels.severity "critical" }}danger{{ else if eq .GroupLabels.severity "warning" }}warning{{ else }}good{{ end }}
      {{ else }}
        good
      {{ end }}
    actions:
      - type: button
        text: 'View in Grafana'
        url: 'https://grafana.yourcompany.com'
      - type: button
        text: 'View Runbook'
        url: '{{ .CommonAnnotations.runbook_url }}'
    fields:
      - title: 'Environment'
        value: '{{ .CommonLabels.env }}'
        short: true
      - title: 'Severity'
        value: '{{ .GroupLabels.severity }}'
        short: true
      - title: 'Firing Alerts'
        value: '{{ .Alerts.Firing | len }}'
        short: true
      - title: 'Resolved Alerts'
        value: '{{ .Alerts.Resolved | len }}'
        short: true

  # Business metrics channel
  - name: 'slack-business'
    api_url: '<YOUR_SLACK_WEBHOOK_URL>'
    channel: '#servicedesk-metrics'
    username: 'ServiceDesk Metrics'
    icon_emoji: ':chart_with_upwards_trend:'
    title: '{{ .GroupLabels.alertname }}'
    text: '{{ .CommonAnnotations.description }}'
    color: 'warning'

  # Security alerts channel
  - name: 'slack-security'
    api_url: '<YOUR_SLACK_WEBHOOK_URL>'
    channel: '#servicedesk-security'
    username: 'ServiceDesk Security'
    icon_emoji: ':rotating_light:'
    title: '[SECURITY] {{ .GroupLabels.alertname }}'
    text: |-
      {{ range .Alerts }}
      *Security Alert:* {{ .Annotations.summary }}
      *Description:* {{ .Annotations.description }}
      *Component:* {{ .Labels.component }}
      {{ if .Annotations.runbook_url }}*Runbook:* {{ .Annotations.runbook_url }}{{ end }}
      {{ end }}
    color: 'danger'

# Example Slack message format:
#
# â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
# â”‚ ğŸ”” HighErrorRate                    â”‚
# â”‚                                     â”‚
# â”‚ Alert: High error rate detected     â”‚
# â”‚ Description: Error rate is 7.2%     â”‚
# â”‚ Severity: critical                  â”‚
# â”‚ Component: application              â”‚
# â”‚ Runbook: https://docs...            â”‚
# â”‚                                     â”‚
# â”‚ Environment: production             â”‚
# â”‚ Severity: critical                  â”‚
# â”‚ Firing Alerts: 1                    â”‚
# â”‚                                     â”‚
# â”‚ [View in Grafana] [View Runbook]    â”‚
# â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
